<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="The package is used to identify anomalies in clinical time series.
    The main goal is to flag sites whose data is different from other sites in the study
    but also outlying individual subjects can be identified with the results generated.
    See details in the provided PHUSE EU Connect 2022 resources.">
<title>The package is used to identify anomalous clinical time series • ctas</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="The package is used to identify anomalous clinical time series">
<meta property="og:description" content="The package is used to identify anomalies in clinical time series.
    The main goal is to flag sites whose data is different from other sites in the study
    but also outlying individual subjects can be identified with the results generated.
    See details in the provided PHUSE EU Connect 2022 resources.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">ctas</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="clinical-timeseries-anomaly-spotter-ctas">Clinical Timeseries Anomaly Spotter (CTAS)<a class="anchor" aria-label="anchor" href="#clinical-timeseries-anomaly-spotter-ctas"></a>
</h1></div>
<p>Pekka Tiikkainen, Bayer Pharmaceuticals</p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>CTAS is an R package for identifying outliers and anomalies in clinical trial time series. Its main focus is on flagging sites with one or more study parameters whose profiles differ from those of the other sites. However, also anomalies for individual subjects can be identified with the results the package gives.</p>
<p>This document focuses on the data format requirements of the input and output data. For details on methodology, please refer to the paper and presentation published at the PHUSE EU Connect 22 meeting. The files are attached to this repository.</p>
</div>
<div class="section level2">
<h2 id="how-to-use-the-package">How to use the package<a class="anchor" aria-label="anchor" href="#how-to-use-the-package"></a>
</h2>
<p>First the clinical data has to be wrangled in a format compatible with the main function’s parameters (please see below for definitions). Please note that data preparation step is intentionally out-of-scope for the package because each user is likely to have their data in a different format.</p>
<p>Then the main function (process_a_study) is called separately for each study you wish to process. The function returns the results as a list of data frames. For details on the output, please see below.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://phuse.s3.eu-central-1.amazonaws.com/Archive/2022/Connect/EU/Belfast/PRE_AR04.pdf" class="external-link">ctas</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: dplyr</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ctas_data"</span>, package <span class="op">=</span> <span class="st">"ctas"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ctas_data</span></span>
<span><span class="co">#&gt; $data</span></span>
<span><span class="co">#&gt; # A tibble: 6,684 × 7</span></span>
<span><span class="co">#&gt;    subject_id timepoint_rank timepoint_1_name result parameter…¹ timep…² basel…³</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;               &lt;int&gt; &lt;chr[1d]&gt;         &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;   &lt;lgl&gt;  </span></span>
<span><span class="co">#&gt;  1 1                       1 AB                 NA   param1      timepo… NA     </span></span>
<span><span class="co">#&gt;  2 1                       2 AC                 31.8 param1      timepo… NA     </span></span>
<span><span class="co">#&gt;  3 1                       3 AD                 36.4 param1      timepo… NA     </span></span>
<span><span class="co">#&gt;  4 1                       4 AE                 33.5 param1      timepo… NA     </span></span>
<span><span class="co">#&gt;  5 1                       5 AF                 34.1 param1      timepo… NA     </span></span>
<span><span class="co">#&gt;  6 1                       6 AG                 NA   param1      timepo… NA     </span></span>
<span><span class="co">#&gt;  7 1                       7 AH                 31.3 param1      timepo… NA     </span></span>
<span><span class="co">#&gt;  8 1                       8 AI                 33.2 param1      timepo… NA     </span></span>
<span><span class="co">#&gt;  9 1                       9 AJ                 35.0 param1      timepo… NA     </span></span>
<span><span class="co">#&gt; 10 1                      10 AK                 NA   param1      timepo… NA     </span></span>
<span><span class="co">#&gt; # … with 6,674 more rows, and abbreviated variable names ¹​parameter_id,</span></span>
<span><span class="co">#&gt; #   ²​timepoint_2_name, ³​baseline</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $parameters</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 11</span></span>
<span><span class="co">#&gt;   parameter_id paramet…¹ param…² param…³ param…⁴ time_…⁵ subje…⁶ max_s…⁷ gener…⁸</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;        &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;lgl&gt;   &lt;lgl&gt;   &lt;lgl&gt;   &lt;lgl&gt;  </span></span>
<span><span class="co">#&gt; 1 param1       param1    catego… catego… catego… NA      NA      NA      NA     </span></span>
<span><span class="co">#&gt; 2 param2       param2    catego… catego… catego… NA      NA      NA      NA     </span></span>
<span><span class="co">#&gt; # … with 2 more variables: timeseries_features_to_calculate &lt;lgl&gt;,</span></span>
<span><span class="co">#&gt; #   use_only_custom_timeseries &lt;lgl&gt;, and abbreviated variable names</span></span>
<span><span class="co">#&gt; #   ¹​parameter_name, ²​parameter_category_1, ³​parameter_category_2,</span></span>
<span><span class="co">#&gt; #   ⁴​parameter_category_3, ⁵​time_point_count_min, ⁶​subject_count_min,</span></span>
<span><span class="co">#&gt; #   ⁷​max_share_missing, ⁸​generate_change_from_baseline</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $subjects</span></span>
<span><span class="co">#&gt; # A tibble: 162 × 4</span></span>
<span><span class="co">#&gt;    subject_id site  country region</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; </span></span>
<span><span class="co">#&gt;  1 1          AAA   AA      A     </span></span>
<span><span class="co">#&gt;  2 2          AAA   AA      A     </span></span>
<span><span class="co">#&gt;  3 3          AAA   AA      A     </span></span>
<span><span class="co">#&gt;  4 4          AAA   AA      A     </span></span>
<span><span class="co">#&gt;  5 5          AAA   AA      A     </span></span>
<span><span class="co">#&gt;  6 6          AAA   AA      A     </span></span>
<span><span class="co">#&gt;  7 7          AAB   AA      A     </span></span>
<span><span class="co">#&gt;  8 8          AAB   AA      A     </span></span>
<span><span class="co">#&gt;  9 9          AAB   AA      A     </span></span>
<span><span class="co">#&gt; 10 10         AAB   AA      A     </span></span>
<span><span class="co">#&gt; # … with 152 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $custom_timeseries</span></span>
<span><span class="co">#&gt; # A tibble: 0 × 3</span></span>
<span><span class="co">#&gt; # … with 3 variables: timeseries_id &lt;chr&gt;, parameter_id &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   timepoint_combo &lt;chr&gt;</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $custom_reference_groups</span></span>
<span><span class="co">#&gt; # A tibble: 0 × 3</span></span>
<span><span class="co">#&gt; # … with 3 variables: parameter_id &lt;chr&gt;, feature &lt;chr&gt;, ref_group &lt;chr&gt;</span></span>
<span></span>
<span><span class="va">feats</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"autocorr"</span>,</span>
<span>    <span class="st">"average"</span>,</span>
<span>    <span class="st">"own_site_simil_score"</span>,</span>
<span>    <span class="st">"sd"</span>,</span>
<span>    <span class="st">"unique_value_count_relative"</span>,</span>
<span>    <span class="st">"lof"</span>,</span>
<span>    <span class="st">"range"</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span>collapse <span class="op">=</span> <span class="st">";"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ls_ctas</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/process_a_study.html">process_a_study</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">ctas_data</span><span class="op">$</span><span class="va">data</span>,</span>
<span>  subjects <span class="op">=</span> <span class="va">ctas_data</span><span class="op">$</span><span class="va">subjects</span>,</span>
<span>  parameters <span class="op">=</span> <span class="va">ctas_data</span><span class="op">$</span><span class="va">parameters</span>,</span>
<span>  custom_timeseries <span class="op">=</span> <span class="va">ctas_data</span><span class="op">$</span><span class="va">custom_timeseries</span>,</span>
<span>  custom_reference_groups <span class="op">=</span> <span class="va">ctas_data</span><span class="op">$</span><span class="va">custom_reference_groups</span>,</span>
<span>  default_timeseries_features_to_calculate <span class="op">=</span> <span class="va">feats</span>,</span>
<span>  default_minimum_timepoints_per_series <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  default_minimum_subjects_per_series <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  default_max_share_missing_timepoints_per_series <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  default_generate_change_from_baseline <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  autogenerate_timeseries <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">ls_ctas</span></span>
<span><span class="co">#&gt; $timeseries</span></span>
<span><span class="co">#&gt; # A tibble: 8 × 6</span></span>
<span><span class="co">#&gt;   timeseries_id         parameter_id baseline timepoint_combo    timep…¹ timep…²</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;                 &lt;chr&gt;        &lt;chr&gt;    &lt;chr&gt;              &lt;chr&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 ts_1_autogen_original param1       original 1;2;3;4;5;6;7;8;9… AB_tim…      31</span></span>
<span><span class="co">#&gt; 2 ts_2_autogen_original param1       original 1;2;3;4;5;6;7;8;9… AB_tim…      28</span></span>
<span><span class="co">#&gt; 3 ts_3_autogen_original param1       original 1;2;3;4;5;6;7;8;9… AB_tim…      24</span></span>
<span><span class="co">#&gt; 4 ts_4_autogen_original param1       original 1;2;3;4;5;6;7;8;9… AB_tim…      20</span></span>
<span><span class="co">#&gt; 5 ts_5_autogen_original param2       original 1;2;3;4;5;6;7;8;9… AB_tim…      31</span></span>
<span><span class="co">#&gt; 6 ts_6_autogen_original param2       original 1;2;3;4;5;6;7;8;9… AB_tim…      30</span></span>
<span><span class="co">#&gt; 7 ts_7_autogen_original param2       original 1;2;3;4;5;6;7;8;9… AB_tim…      26</span></span>
<span><span class="co">#&gt; 8 ts_8_autogen_original param2       original 1;2;3;4;5;6;7;8;9… AB_tim…      22</span></span>
<span><span class="co">#&gt; # … with abbreviated variable names ¹​timepoint_combo_readable, ²​timepoint_count</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $timeseries_features</span></span>
<span><span class="co">#&gt; # A tibble: 5,706 × 7</span></span>
<span><span class="co">#&gt;    timeseries_id         subject_id feature        featur…¹ site  country region</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                 &lt;chr&gt;      &lt;chr&gt;             &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt; </span></span>
<span><span class="co">#&gt;  1 ts_1_autogen_original 1          range           6.44    AAA   AA      A     </span></span>
<span><span class="co">#&gt;  2 ts_1_autogen_original 1          sd              1.66    AAA   AA      A     </span></span>
<span><span class="co">#&gt;  3 ts_1_autogen_original 1          unique_value_…  1       AAA   AA      A     </span></span>
<span><span class="co">#&gt;  4 ts_1_autogen_original 1          autocorr       -0.393   AAA   AA      A     </span></span>
<span><span class="co">#&gt;  5 ts_1_autogen_original 1          average        33.9     AAA   AA      A     </span></span>
<span><span class="co">#&gt;  6 ts_1_autogen_original 1          lof             0.996   AAA   AA      A     </span></span>
<span><span class="co">#&gt;  7 ts_1_autogen_original 11         range           6.84    AAC   AA      A     </span></span>
<span><span class="co">#&gt;  8 ts_1_autogen_original 11         sd              1.90    AAC   AA      A     </span></span>
<span><span class="co">#&gt;  9 ts_1_autogen_original 11         unique_value_…  1       AAC   AA      A     </span></span>
<span><span class="co">#&gt; 10 ts_1_autogen_original 11         autocorr       -0.00259 AAC   AA      A     </span></span>
<span><span class="co">#&gt; # … with 5,696 more rows, and abbreviated variable name ¹​feature_value</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $PCA_coordinates</span></span>
<span><span class="co">#&gt; # A tibble: 822 × 4</span></span>
<span><span class="co">#&gt;    timeseries_id         subject_id    pc1     pc2</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;                 &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 ts_1_autogen_original 1          -16.6   -1.57 </span></span>
<span><span class="co">#&gt;  2 ts_1_autogen_original 11          16.1    0.857</span></span>
<span><span class="co">#&gt;  3 ts_1_autogen_original 15          27.9   -1.62 </span></span>
<span><span class="co">#&gt;  4 ts_1_autogen_original 16         -34.4    6.17 </span></span>
<span><span class="co">#&gt;  5 ts_1_autogen_original 17           7.19  -2.61 </span></span>
<span><span class="co">#&gt;  6 ts_1_autogen_original 20           6.33  -0.144</span></span>
<span><span class="co">#&gt;  7 ts_1_autogen_original 21           5.30  14.9  </span></span>
<span><span class="co">#&gt;  8 ts_1_autogen_original 26         -32.1   -3.02 </span></span>
<span><span class="co">#&gt;  9 ts_1_autogen_original 28          -1.96 -21.4  </span></span>
<span><span class="co">#&gt; 10 ts_1_autogen_original 31           1.33   5.71 </span></span>
<span><span class="co">#&gt; # … with 812 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $site_scores</span></span>
<span><span class="co">#&gt; # A tibble: 1,765 × 10</span></span>
<span><span class="co">#&gt;    timese…¹ site  country region feature pvalu…² kstes…³ fdr_c…⁴ ref_g…⁵ subje…⁶</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;  &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 ts_1_au… AAA   AA      A      range    0.680    0.909 0.0305  global        1</span></span>
<span><span class="co">#&gt;  2 ts_1_au… AAC   AA      A      range    0.571    0.879 0.0305  global        1</span></span>
<span><span class="co">#&gt;  3 ts_1_au… AAD   AA      A      range    0.191    0.391 0.00685 global        3</span></span>
<span><span class="co">#&gt;  4 ts_1_au… ABA   AB      A      range    1.08     0.603 0.0905  global        4</span></span>
<span><span class="co">#&gt;  5 ts_1_au… ABB   AB      A      range    0.0966   0.415 0.00312 global        2</span></span>
<span><span class="co">#&gt;  6 ts_1_au… ABC   AB      A      range    0.248    0.492 0.0108  global        2</span></span>
<span><span class="co">#&gt;  7 ts_1_au… ACA   AC      A      range    0.391    0.421 0.0108  global        4</span></span>
<span><span class="co">#&gt;  8 ts_1_au… ADA   AD      A      range    0.571    0.879 0.0305  global        1</span></span>
<span><span class="co">#&gt;  9 ts_1_au… ADB   AD      A      range    0.934    0.571 0.0402  global        4</span></span>
<span><span class="co">#&gt; 10 ts_1_au… ADC   AD      A      range    0.910    0.769 0.0402  global        2</span></span>
<span><span class="co">#&gt; # … with 1,755 more rows, and abbreviated variable names ¹​timeseries_id,</span></span>
<span><span class="co">#&gt; #   ²​pvalue_kstest_logp, ³​kstest_statistic, ⁴​fdr_corrected_pvalue_logp,</span></span>
<span><span class="co">#&gt; #   ⁵​ref_group, ⁶​subject_count</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="input-parameters">Input parameters<a class="anchor" aria-label="anchor" href="#input-parameters"></a>
</h2>
<p>The function process_a_study has a number of parameters that need to be provided. Some of these are data frames while others are simple variables.</p>
<p>The following gives more details on each parameter. Examples are also provided where needed.</p>
<div class="section level3">
<h3 id="timeseries_features_to_calculate">timeseries_features_to_calculate<a class="anchor" aria-label="anchor" href="#timeseries_features_to_calculate"></a>
</h3>
<p>Vector of features to calculate for each time series. The vector must contain at least one of the following feature codes:</p>
<table class="table">
<colgroup>
<col width="50%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Feature code</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>autocorr</td>
<td>Auto-correlation</td>
</tr>
<tr class="even">
<td>average</td>
<td>Average value</td>
</tr>
<tr class="odd">
<td>own_site_simil_score</td>
<td>Measure of co-clustering of time series from the same study site</td>
</tr>
<tr class="even">
<td>sd</td>
<td>Standard deviation</td>
</tr>
<tr class="odd">
<td>unique_value_count_relative</td>
<td>Number of unique values divided by number of values available</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="default_minimum_timepoints_per_series">default_minimum_timepoints_per_series<a class="anchor" aria-label="anchor" href="#default_minimum_timepoints_per_series"></a>
</h3>
<p>Minimum number of time points for auto-generated time series. This value will be used for a parameter if they do not have the time_point_count_min column defined in the parameters df.</p>
</div>
<div class="section level3">
<h3 id="default_minimum_subjects_per_series">default_minimum_subjects_per_series<a class="anchor" aria-label="anchor" href="#default_minimum_subjects_per_series"></a>
</h3>
<p>Minimum number of eligible subjects for auto-generated time series. This value will be used for a parameter if they do not have the subject_count_min column defined in the parameters df.</p>
</div>
<div class="section level3">
<h3 id="default_max_share_missing_timepoints_per_series">default_max_share_missing_timepoints_per_series<a class="anchor" aria-label="anchor" href="#default_max_share_missing_timepoints_per_series"></a>
</h3>
<p>Maximum share of missing time points a subject can have in order to be eligible for a time series. This value will be used for a parameter if they do not have the max_share_missing defined in the parameters df.</p>
</div>
<div class="section level3">
<h3 id="default_generate_change_from_baseline">default_generate_change_from_baseline<a class="anchor" aria-label="anchor" href="#default_generate_change_from_baseline"></a>
</h3>
<p>If TRUE, change-from-baseline adjusted version of each time series is generated (in addition to the time series with actual measurements).</p>
</div>
<div class="section level3">
<h3 id="autogenerate_timeseries">autogenerate_timeseries<a class="anchor" aria-label="anchor" href="#autogenerate_timeseries"></a>
</h3>
<p>If TRUE, time series are autogenerated in a data-driven matter for all parameters. If set to FALSE, the custom_timeseries data frame must have at least one entry.</p>
</div>
<div class="section level3">
<h3 id="subjects">subjects<a class="anchor" aria-label="anchor" href="#subjects"></a>
</h3>
<p>Data frame with one row per study subject.</p>
<p>Data frame columns:</p>
<table class="table">
<colgroup>
<col width="16%">
<col width="13%">
<col width="18%">
<col width="50%">
</colgroup>
<thead><tr class="header">
<th>Column name</th>
<th>Data type</th>
<th>Data required</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>subject_id</td>
<td>chr</td>
<td>Y</td>
<td>Unique identifier for each subject</td>
</tr>
<tr class="even">
<td>country</td>
<td>chr</td>
<td>Y</td>
<td>Country where the subject is enrolled.</td>
</tr>
<tr class="odd">
<td>site</td>
<td>chr</td>
<td>Y</td>
<td>Name of the study site.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="parameters">parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h3>
<p>Data frame with one row for each parameter that should be processed. Parameters are, for example, laboratory assays and vital sign measurements done during the course of a study.</p>
<p>Data frame columns:</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th>Column name</th>
<th>Data type</th>
<th>Data required</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>parameter_id</td>
<td>chr</td>
<td>Y</td>
<td>Parameter identifier</td>
</tr>
<tr class="even">
<td>parameter_category_1</td>
<td>chr</td>
<td></td>
<td>Top level category of the parameter (e.g. LB for a laboratory assay).</td>
</tr>
<tr class="odd">
<td>parameter_category_2</td>
<td>chr</td>
<td></td>
<td>Second level category of the parameter (e.g. General chemistry for a laboratory assay).</td>
</tr>
<tr class="even">
<td>parameter_category_3</td>
<td>chr</td>
<td></td>
<td>Third level category of the parameter (e.g. Local lab for a laboratory assay).</td>
</tr>
<tr class="odd">
<td>parameter_name</td>
<td>chr</td>
<td>Y</td>
<td>Parameter name</td>
</tr>
<tr class="even">
<td>time_point_count_min</td>
<td>int</td>
<td></td>
<td>Minimum number of time points required for auto-generated time series. If not provided, global default value is used.</td>
</tr>
<tr class="odd">
<td>subject_count_min</td>
<td>int</td>
<td></td>
<td>Minimum number of eligible subjects required for auto-generated time series. If not provided, global default value is used.</td>
</tr>
<tr class="even">
<td>max_share_missing</td>
<td>float</td>
<td></td>
<td>Maximum number of missing data points an eligible subject can have for auto-generated time series. If not provided, global default value is used.</td>
</tr>
<tr class="odd">
<td>generate_change_from_baseline</td>
<td>boolean</td>
<td></td>
<td>Whether to also generate baseline-adjusted time series for the parameter. If not provided, global default value is used.</td>
</tr>
</tbody>
</table>
<p>Example for two parameters, one vital sign and one local lab. For any time series generated for the vital sign, at least 50 eligible subjects are required. For the local lab, time series with one time point only are acceptable. These parameter-specific properties override the corresponding global parameters (see above).</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th>parameter_id</th>
<th>parameter_category_1</th>
<th>parameter_category_2</th>
<th>parameter_category_3</th>
<th>parameter_name</th>
<th>time_point_count_min</th>
<th>subject_count_min</th>
<th>max_share_missing</th>
<th>generate_change_from_baseline</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>dummy_param_1</td>
<td>VS</td>
<td>NA</td>
<td>NA</td>
<td>DIABP</td>
<td></td>
<td>50</td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td>dummy_param_2</td>
<td>LB</td>
<td>General chemistry</td>
<td>Local lab</td>
<td>Glucose</td>
<td>1</td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="data">data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>Data frame for the data collected during the study with one row per data point.</p>
<p>Data frame columns:</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th>Column name</th>
<th>Data type</th>
<th>Data required</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>subject_id</td>
<td>chr</td>
<td>Y</td>
<td>Pointer to the subject identifier in the subjects table.</td>
</tr>
<tr class="even">
<td>parameter_id</td>
<td>chr</td>
<td>Y</td>
<td>Pointer to the parameter identifier in the parameters table.</td>
</tr>
<tr class="odd">
<td>timepoint_1_name</td>
<td>chr</td>
<td>Y</td>
<td>Name of the top level time point (e.g. Visit 1).</td>
</tr>
<tr class="even">
<td>timepoint_2_name</td>
<td>chr</td>
<td></td>
<td>Name of the second level time point (e.g. “30 mins after dosing”).</td>
</tr>
<tr class="odd">
<td>timepoint_rank</td>
<td>int</td>
<td>Y</td>
<td>Integer for ranking time points into chronological order. Ranking is separate for each parameter.</td>
</tr>
<tr class="even">
<td>result</td>
<td>float</td>
<td>Y</td>
<td>Numerical result of the parameter.</td>
</tr>
<tr class="odd">
<td>baseline</td>
<td>float</td>
<td></td>
<td>Possible baseline value for the parameter and the subject. This is used to calculate change-from-baseline time series.</td>
</tr>
</tbody>
</table>
<p>Example of data contents:</p>
<table style="width:100%;" class="table">
<colgroup>
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
<col width="14%">
</colgroup>
<thead><tr class="header">
<th>subject_id</th>
<th>parameter_id</th>
<th>timepoint_1_name</th>
<th>timepoint_2_name</th>
<th>timepoint_rank</th>
<th>result</th>
<th>baseline</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>subj_1</td>
<td>dummy_param_1</td>
<td>Visit 1</td>
<td>pre-dose</td>
<td>1</td>
<td>72</td>
<td>65</td>
</tr>
<tr class="even">
<td>subj_1</td>
<td>dummy_param_1</td>
<td>Visit 1</td>
<td>post-dose</td>
<td>2</td>
<td>81</td>
<td>65</td>
</tr>
<tr class="odd">
<td>subj_1</td>
<td>dummy_param_1</td>
<td>Visit 2</td>
<td>NA</td>
<td>3</td>
<td>69</td>
<td>65</td>
</tr>
<tr class="even">
<td>subj_1</td>
<td>dummy_param_1</td>
<td>Visit 3</td>
<td>NA</td>
<td>4</td>
<td>70</td>
<td>65</td>
</tr>
<tr class="odd">
<td>subj_1</td>
<td>dummy_param_2</td>
<td>Visit 3</td>
<td>NA</td>
<td>1</td>
<td>85</td>
<td>84</td>
</tr>
<tr class="even">
<td>subj_2</td>
<td>dummy_param_2</td>
<td>Visit 3</td>
<td>NA</td>
<td>1</td>
<td>102</td>
<td>96</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="custom_timeseries">custom_timeseries<a class="anchor" aria-label="anchor" href="#custom_timeseries"></a>
</h3>
<p>The study team might be interested in specific time series - for instance in an oncology trial one might be interested in data collected in the first two treatment cycles.</p>
<p>When time series are auto-generated in a data-driven manner, it cannot be guaranteed that a particular time series is generated. To make sure that a specific time series is analyzed, this can be defined with the <em>custom_timeseries</em> data frame.</p>
<p>Please note: if you do not have any custom time series to process, you still have to provide the main function a blank data frame!</p>
<p>Data frame columns:</p>
<table class="table">
<colgroup>
<col width="25%">
<col width="25%">
<col width="25%">
<col width="25%">
</colgroup>
<thead><tr class="header">
<th>Column name</th>
<th>Data type</th>
<th>Data required</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>timeseries_id</td>
<td>chr</td>
<td>Y</td>
<td>Identifier for the the custom time series.</td>
</tr>
<tr class="even">
<td>parameter_id</td>
<td>chr</td>
<td>Y</td>
<td>Pointer to the parameter identifier in the parameters table.</td>
</tr>
<tr class="odd">
<td>timepoint_combo</td>
<td>chr</td>
<td>Y</td>
<td>Semicolon-delimited string of timepoint ranks that the time series consists of. These must match values in the timepoint_rank column of the data df.</td>
</tr>
</tbody>
</table>
<p>In the example below, a custom time series has been defined for dummy_param_1. Timepoints are defined with their respective ranks in the <em>data</em> df.</p>
<table class="table">
<thead><tr class="header">
<th>timeseries_id</th>
<th>parameter_id</th>
<th>timepoint_combo</th>
</tr></thead>
<tbody><tr class="odd">
<td>custom_ts_1</td>
<td>dummy_param_1</td>
<td>1;2;3;4</td>
</tr></tbody>
</table>
</div>
</div>
<div class="section level2">
<h2 id="output-data">Output data<a class="anchor" aria-label="anchor" href="#output-data"></a>
</h2>
<p>Output is a list of four data frames. Their details are explained in the following.</p>
<div class="section level3">
<h3 id="timeseries">timeseries<a class="anchor" aria-label="anchor" href="#timeseries"></a>
</h3>
<p>Time series processed. Contains both the auto-generated and/or custom time series.</p>
<p>Data frame columns:</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Column name</th>
<th>Data type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>timeseries_id</td>
<td>chr</td>
<td>Unique identifier for the time series.</td>
</tr>
<tr class="even">
<td>parameter_id</td>
<td>chr</td>
<td>The parameter the time series is for.</td>
</tr>
<tr class="odd">
<td>baseline</td>
<td>chr</td>
<td>Whether the time series values are original measurements or baseline-adjusted.</td>
</tr>
<tr class="even">
<td>timepoint_combo</td>
<td>chr</td>
<td>Ranks of the time points that constitute the time series. Semicolon delimited string.</td>
</tr>
<tr class="odd">
<td>timepoint_combo_readable</td>
<td>chr</td>
<td>Names of the time points that constitute the time series. Semicolon-delimited string.</td>
</tr>
<tr class="even">
<td>timepoint_count</td>
<td>int</td>
<td>Number of timepoints in the time series.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="timeseries_features">timeseries_features<a class="anchor" aria-label="anchor" href="#timeseries_features"></a>
</h3>
<p>Data frame with features calculated for time series.</p>
<p>Data frame columns:</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Column name</th>
<th>Data type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>timeseries_id</td>
<td>chr</td>
<td>Unique identifier of the time series. Points to the timeseries table.</td>
</tr>
<tr class="even">
<td>subject_id</td>
<td>chr</td>
<td>Subject ID pointing to the input df subjects.</td>
</tr>
<tr class="odd">
<td>feature</td>
<td>chr</td>
<td>Feature code.</td>
</tr>
<tr class="even">
<td>feature_value</td>
<td>float</td>
<td>Feature value.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="pca_coordinates">PCA_coordinates<a class="anchor" aria-label="anchor" href="#pca_coordinates"></a>
</h3>
<p>Data frame with the top two principal components for a time series. These are useful for the visualization of the similarity of subjects.</p>
<p>Data frame columns:</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Column name</th>
<th>Data type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>timeseries_id</td>
<td>chr</td>
<td>Unique identifier of the time series. Points to the timeseries table.</td>
</tr>
<tr class="even">
<td>subject_id</td>
<td>chr</td>
<td>Subject ID pointing to the input df subjects.</td>
</tr>
<tr class="odd">
<td>pc1</td>
<td>float</td>
<td>The first principal component.</td>
</tr>
<tr class="even">
<td>pc2</td>
<td>float</td>
<td>The second principal component.</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="site_scores">site_scores<a class="anchor" aria-label="anchor" href="#site_scores"></a>
</h3>
<p>Biasness scores for sites. The data frame contains a row for each site/time series/feature combination.</p>
<p>Data frame columns:</p>
<table class="table">
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th>Column name</th>
<th>Data type</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>timeseries_id</td>
<td>chr</td>
<td>Unique identifier of the time series. Points to the timeseries table.</td>
</tr>
<tr class="even">
<td>site</td>
<td>chr</td>
<td>Study site for which the score has been calculated.</td>
</tr>
<tr class="odd">
<td>country</td>
<td>chr</td>
<td>Site’s country.</td>
</tr>
<tr class="even">
<td>feature</td>
<td>chr</td>
<td>Time series feature the score is for.</td>
</tr>
<tr class="odd">
<td>pvalue_kstest_logp</td>
<td>float</td>
<td>Negative logarithm of the raw p-value.</td>
</tr>
<tr class="even">
<td>kstest_statistic</td>
<td>float</td>
<td>Test statistic of the Kolmogorov-Smirnov test.</td>
</tr>
<tr class="odd">
<td>fdr_corrected_pvalue_logp</td>
<td>float</td>
<td>Site score: negative logarithm of the multiple testing corrected p-value. FDR (False Discovery Rate) is used for correction.</td>
</tr>
<tr class="even">
<td>reference_group</td>
<td>chr</td>
<td>Reference group for the site. “All” means that the site has been compared to all sites in the study.</td>
</tr>
<tr class="odd">
<td>subject_count</td>
<td>int</td>
<td>Number of site subjects who are eligible for the time series.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

  </main><aside class="col-md-3"><div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php" class="external-link">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ctas</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Pekka Tiikkainen <br><small class="roles"> Author, maintainer </small>  </li>
<li>Björn Koneswarakantha <br><small class="roles"> Author </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/IMPALA-Consortium/ctas/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/IMPALA-Consortium/ctas/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Pekka Tiikkainen, Björn Koneswarakantha.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
